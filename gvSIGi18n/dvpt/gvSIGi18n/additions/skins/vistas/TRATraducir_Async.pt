<tal:block replace="nothing">
# File: TRATraducir_Async.pt
#
# Copyright (c) 2008, 2009,2010 by Conselleria de Infraestructuras y Transporte de la
# Generalidad Valenciana
#
# GNU General Public License (GPL)
#
# This program is free software; you can redistribute it and/or
# modify it under the terms of the GNU General Public License
# as published by the Free Software Foundation; either version 2
# of the License, or (at your option) any later version.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with this program; if not, write to the Free Software
# Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA
# 02110-1301, USA.
#
# Authors: 
# Conselleria de Infraestructuras y Transporte de la Generalidad Valenciana 
# Model Driven Development sl  Valencia (Spain) www.ModelDD.org 
# Antonio Carrasco Valero                       carrasco@ModelDD.org
#
#
</tal:block>
   
<tal:block tal:define="
    pExecutionRecord python: here.fStartExecution( 'template', 'TRATraducir_Async.pt', None, True, { 'log_what': 'details', 'log_when': True, });
    pPermissionsCache python: {};
    pRolesCache python: {}"><tal:block 
    tal:define="
        pFormSubmit             python: request.get( 'form_submit', '');
        pRequestedChangeKind    python: ( ( pFormSubmit == 'InvalidarTraduccionesCadena') and 'InvalidarTraduccionesCadena') or  ( ( pFormSubmit == 'Pendiente') and 'ChangeToPending') or ( ( pFormSubmit == 'Traducida') and  'ChangeToTranslated')  or ( ( pFormSubmit == 'Revisada') and 'ChangeToReviewed')  or ( ( pFormSubmit == 'Definitiva') and 'ChangeToLocked') or ( ( pFormSubmit == 'Comment') and 'Comment') or 'TryToTranslate';
        pServiceResult python: here.fService_ChangeTranslation( 
            {   'sleep_seconds':                '0.0', 
                'change_counter':               request.get( 'theChgCtr',    ''),
                'requested_change_kind':        pRequestedChangeKind,                
                'codigo_idioma_a_traducir':     request.get( 'theCodigoIdiomaATraducir',    ''),
                'simbolo_cadena_a_traducir':    request.get( 'theSimboloCadenaATraducir',   ''),
                'cadena_traducida':             request.get( 'theCadenaTraducida',          ''),
            },
            pPermissionsCache,
            pRolesCache,
            pExecutionRecord);
        unServiceSuccess                python:  ( pServiceResult or {}).get( 'success', False);
        unChangeResult                  python:  ( pServiceResult or {}).get( 'change_result', {});
        unChangedSuccess                python:  ( unChangeResult or {}).get( 'success', False);
        unChangeStatus                  python:  ( unChangeResult or {}).get( 'status', '');
        unChangeMessage                 python:  ( unChangeStatus and ( unChangeStatus == 'DifferentChangeCounter') and here.fTranslateI18N( 'gvSIGi18n', 'gvSIGi18n_TranslationChangedByOtherTransaction', 'Translation Changed by other transaction or user-')) or '';
        theCodigoIdiomaATraducir        python:  here.fAsUnicode( pServiceResult.get( 'codigo_idioma_a_traducir', u''));
        theSimboloCadenaATraducir       python:  here.fAsUnicode( pServiceResult.get( 'simbolo_cadena_a_traducir', u''));
        theCadenaTraducida_solicitada   python:  here.fAsUnicode( pServiceResult.get( 'cadena_traducida_solicitada', u''));
        theComentario_solicitado        python:  here.fAsUnicode( pServiceResult.get( 'comentario_solicitado', u''));
        unRetrievalResult               python:  ( pServiceResult or {}).get( 'retrieval_result', {});
        unRetrievalSuccess              python:  ( unRetrievalResult or {}).get( 'success', False);
        unDatosTraducciones             python:  ( unRetrievalResult or {}).get( 'datosTraducciones', []);
        unosDatosTraduccion             python:  ( unDatosTraducciones and unDatosTraducciones[ 0]) or {};
        unaNuevaCadenaTraducida         python:  ( unosDatosTraduccion and unosDatosTraduccion[ 'getCadenaTraducida']) or '';
        unNuevoEstadoTraduccion         python:  ( unosDatosTraduccion and unosDatosTraduccion[ 'getEstadoTraduccion']) or '';
        unNuevoUsuarioTraductor         python:  ( unosDatosTraduccion and unosDatosTraduccion[ 'getUsuarioTraductor']) or '';
        unaNuevaFechaTraduccion         python:  ( unosDatosTraduccion and unosDatosTraduccion[ 'getFechaTraduccionTextual']) or '';
        unNuevoUsuarioRevisor           python:  ( unosDatosTraduccion and unosDatosTraduccion[ 'getUsuarioRevisor']) or '';
        unaNuevaFechaRevision           python:  ( unosDatosTraduccion and unosDatosTraduccion[ 'getFechaRevisionTextual']) or '';
        unNuevoUsuarioCoordinador       python:  ( unosDatosTraduccion and unosDatosTraduccion[ 'getUsuarioCoordinador']) or '';
        unaNuevaFechaDefinitivo         python:  ( unosDatosTraduccion and unosDatosTraduccion[ 'getFechaDefinitivoTextual']) or '';
        unChangesCounter                python:  str( ( unosDatosTraduccion and unosDatosTraduccion[ 'getContadorCambios']) or 0);
        unasAllowedStateTransitions     python:  ( unRetrievalResult or {}).get( 'allowed_state_transitions', {});
        unosTargetStateChanges          python:  ' '.join( (unasAllowedStateTransitions or {}).get( unNuevoEstadoTraduccion, {}))"
><span id="cid_AsyncResponse_success"                        tal:content="python: (unServiceSuccess and 'true') or 'false'" />
<span id="cid_AsyncResponse_form_submit"                    tal:content="pFormSubmit" />
<span id="cid_AsyncResponse_RequestedChangeKind"            tal:content="pRequestedChangeKind" />
<span id="cid_AsyncResponse_theCadenaTraducida_solicitada"  tal:content="theCadenaTraducida_solicitada" />
<span id="cid_AsyncResponse_theSimboloCadenaATraducir"      tal:content="theSimboloCadenaATraducir" />
<span id="cid_AsyncResponse_theComentario_solicitado"       tal:content="unServiceSuccess" />
<span id="cid_AsyncResponse_changed"                        tal:content="python: (unChangedSuccess and 'true') or 'false'" />
<span id="cid_AsyncResponse_theCadenaTraducida"             tal:content="unaNuevaCadenaTraducida" />
<span id="cid_AsyncResponse_theEstadoTraduccion"            tal:content="unNuevoEstadoTraduccion" />
<span id="cid_AsyncResponse_theTargetStateChanges"          tal:content="unosTargetStateChanges" />
<span id="cid_AsyncResponse_theChangesCounter"              tal:content="unChangesCounter" />
<span id="cid_AsyncResponse_theChangeStatus"                tal:content="unChangeStatus" />
<span id="cid_AsyncResponse_theChangeMessage"               tal:content="unChangeMessage" />
<tal:block tal:define="dummy python: pExecutionRecord and here.pEndExecution( pExecutionRecord)" />
<div  id="cid_AsyncResponse_theExecutionProfileResult"  tal:condition="request/theRenderProfileAsync | nothing" >
    <tal:block tal:replace="structure python: pExecutionRecord and here.TRARenderExecutionDetails( pExecutionRecord, theCollapsible=False,)" />
</div>
</tal:block>
</tal:block>


    
           
 