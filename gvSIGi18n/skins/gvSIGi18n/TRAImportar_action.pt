<tal:block replace="nothing">
# File: TRAImportar_action.pt
#
# Copyright (c) 2008, 2009 by Conselleria de Infraestructuras y Transporte de la
# Generalidad Valenciana
#
# GNU General Public License (GPL)
#
# This program is free software; you can redistribute it and/or
# modify it under the terms of the GNU General Public License
# as published by the Free Software Foundation; either version 2
# of the License, or (at your option) any later version.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with this program; if not, write to the Free Software
# Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA
# 02110-1301, USA.
#
# Authors: 
# Conselleria de Infraestructuras y Transporte de la Generalidad Valenciana 
# Model Driven Development sl  Valencia (Spain) www.ModelDD.org 
# Antonio Carrasco Valero                       carrasco@ModelDD.org
#
</tal:block>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      lang="en"
      metal:use-macro="here/main_template/macros/master"
      i18n:domain="plone">
<body>                     
<metal:main fill-slot="main">
    <tal:main-macro metal:define-macro="main"
        tal:define="text string:Catalogo de cadenas y sus traduciones a varios idiomas.
        global pStartTime       pStartTime | python: here.ModelDDvlPlone_tool.fMillisecondsNow()" 
        i18n:domain="gvSIGi18n">

        <metal:block metal:use-macro="here/TRAProfileExecution/macros/tSetupProfileExecution" />   


        <tal:block tal:define="pExecutionRecord python: here.fStartExecution( 'template', 'TRAImportar_action.pt', None, pAllowRootProfileExecution, { 'log_what': 'details', 'log_when': True, })" >
    
            <div metal:use-macro="here/document_actions/macros/document_actions">
                Document actions (print, sendto etc)
            </div>
    
            <h1 tal:content="object_title" class="documentFirstHeading">
              Title or id
            </h1>
    
            <div metal:use-macro="here/document_byline/macros/byline">
              Get the byline - contains details about author and modification date.
            </div>
            
            
            <tal:block tal:condition="python: not here.fAllowWrite()" >
                <div class="portalMessage" >
                    <span tal:content="python: here.ModelDDvlPlone_tool.fTranslateI18N( here, 'gvSIGi18n', 'gvSIGi18n_TranslationsCatalogIsLockedAgainstModifications', 'The Translations Catalog Is Locked Against Modifications')" />
                </div>
            </tal:block>
            
     
            <tal:block tal:define="pPermiteEditar python: False; pPermiteEliminar python: False; pShowOrHideTrees python: False">
                <metal:block metal:use-macro="here/TRACabeceraEnTabla_i18n_view/macros/tCabeceraEnTabla_i18n" />   
            </tal:block>
    
           <tal:block tal:define="pPuedeImportar python: here.fRoleQuery_IsManagerOrCoordinator() and here.fNoHaComenzadoOEnDevelopmentODebug()">
                <tal:block tal:condition="not: pPuedeImportar">
                   <font size="3">
                        <strong>
                            <a href="#" title="#"  
                                tal:define="aLinkTitle python: here.fTranslateI18N( 'gvSIGi18n', 'gvSIGi18n_noPuedeImportarYVolverATabular_msgid',   'You can not import translations contents. Please navigate back to import tabular view.-' )"
                                tal:attributes="
                                    title aLinkTitle;
                                    href python: '%s/Tabular/' % here.absolute_url()">
                                <span tal:content="aLinkTitle" />
                            </a>
                        </strong>
                    </font>
                    <p class="formHelp" tal:content="python: here.fTranslateI18N( 'gvSIGi18n', 'gvSIGi18n_noPuedeImportarYVolverATabular_help', 'You may not have the proper rights to launch an import process. If you do, please make sure that you are logged in the site with the proper user account. It is not allowed to launch again an import process that has already been started.')" />
                    <br/>
                </tal:block>
                
                <tal:block tal:condition="pPuedeImportar">
                    <tal:block tal:define="
                        pConfirmMagicMilliseconds python: request.get( 'theConfirm', '');
                        pIsAcceptableMagicMilliseconds python: here.fIsAcceptableMagicMilliseconds ( pConfirmMagicMilliseconds, here.getSegundosParaConfirmarImportacion() or 120)" >
                        <tal:block tal:condition="not: pIsAcceptableMagicMilliseconds">
                            <p><font size="3" color="red"><strong tal:content="python: here.fTranslateI18N( 'gvSIGi18n', 'gvSIGi18n_demasiadaEsperaVuelvaASolicitarImportacion_help', 'You have waited too long to confirm the import operation. Please, request the operation again if you wish to do so.-')" /></font>                 
                            <br/>
                            <p>
                                <font size="3">
                                    <strong>
                                        <a href="#" title="#"  
                                            tal:define="aLinkTitle python: here.fTranslateI18N( 'gvSIGi18n', 'gvSIGi18n_cancelarImportacionYVolverATabular_msgid',   'Cancel import of translations contents and navigate back to import tabular view-' )"
                                            tal:attributes="
                                                title aLinkTitle;
                                                href python: '%s/Tabular/' % here.absolute_url()">
                                            <span tal:content="aLinkTitle" />
                                        </a>
                                    </strong>
                                </font>
                            </p>
                            <p class="formHelp" tal:content="python: here.fTranslateI18N( 'gvSIGi18n', 'gvSIGi18n_cancelarImportacionYVolverATabular_help', 'You may observe the progress of the import process by clicking in the Progress action above or the Observe import progress link below.')" />
                            <br/>
                            <br/>
                        </tal:block>
                        <tal:block tal:condition="pIsAcceptableMagicMilliseconds">
                            <tal:block tal:define="
                                pPermissionsCache python: {}; 
                                pRolesCache python: {};
                                dummy  python:here.fImportarContenidosIntercambio( False, pPermissionsCache, pRolesCache, pExecutionRecord)" />
                            <tal:block tal:define="dummy python:request.response.redirect( '%s/TRAImportacionProgreso/' % here.absolute_url())" />
                        </tal:block>
                    </tal:block>
                </tal:block>
            </tal:block>
                                  
            <tal:block tal:define="dummy python: pExecutionRecord and here.pEndExecution( pExecutionRecord)" />
   
            <metal:block metal:use-macro="here/TRAFooter_i18n_view/macros/tFooter_i18n" />
    
            <!-- ACV 20090928 Execution details of an import operation my be really big. 
                 Do not present to the user unless specifically asked for by passing a request parameter theRenderProfile set to string value "on"
               -->            
            <tal:block tal:condition="request/theRenderProfile | nothing"
                tal:replace="structure python: pExecutionRecord and here.TRARenderExecutionDetails( pExecutionRecord)" />
            
        </tal:block>
        
     </tal:main-macro>
</metal:main>

</body>
</html>



